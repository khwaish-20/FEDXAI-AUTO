<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FEDXAI V7 Ultimate</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Rajdhani:wght@400;600;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            background-color: #020617;
            color: #e2e8f0;
            font-family: 'Rajdhani', sans-serif;
            background-image: radial-gradient(circle at 70% 30%, #1e293b 0%, #020617 70%);
            height: 100vh;
            overflow: hidden;
        }

        .font-hud {
            font-family: 'Orbitron', sans-serif;
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(56, 189, 248, 0.15);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.6);
        }

        .nav-btn.active {
            background: rgba(56, 189, 248, 0.1);
            color: #38bdf8;
            border-bottom: 2px solid #38bdf8;
        }

        /* Interactive Icons */
        .part-icon-group {
    position: absolute;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 20;
}


        .part-icon {
            color: #64748b;
            font-size: 18px;
            transition: all 0.3s;
            filter: drop-shadow(0 0 2px rgba(0, 0, 0, 0.8));
        }

        .part-label {
            opacity: 0;
            transform: translateY(5px);
            transition: all 0.2s;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid #38bdf8;
            padding: 2px 6px;
            border-radius: 4px;
            color: #38bdf8;
            font-size: 9px;
            font-family: 'Orbitron';
            white-space: nowrap;
            margin-top: 4px;
            pointer-events: none;
        }

        .part-icon-group:hover .part-icon {
            color: #38bdf8;
            transform: scale(1.3);
        }

        .part-icon-group:hover .part-label {
            opacity: 1;
            transform: translateY(0);
        }

        /* Critical State */
        .part-critical .part-icon {
            color: #ef4444 !important;
            animation: pulse-icon 1s infinite;
            filter: drop-shadow(0 0 8px #ef4444);
        }

        .part-critical .part-label {
            opacity: 1;
            border-color: #ef4444;
            color: #ef4444;
        }

        @keyframes pulse-icon {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.2);
            }

            100% {
                transform: scale(1);
            }
        }

        /* Custom Scrollbar for Health Page */
        .overflow-y-auto::-webkit-scrollbar {
            width: 6px;
        }

        .overflow-y-auto::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 3px;
        }

        /* Car SVG Styles */
        .car-path {
            fill: url(#bodyGrad);
            stroke: #38bdf8;
            stroke-width: 2;
            filter: drop-shadow(0 0 5px rgba(56, 189, 248, 0.3));
        }

        .wheel {
            stroke: #475569;
            stroke-width: 3;
            fill: none;
        }
    </style>
</head>

<body class="flex flex-col h-screen">

    <!-- Navbar -->
    <nav
        class="flex justify-between items-center px-4 py-2 border-b border-slate-800 bg-slate-950/90 z-50 h-12 shrink-0">
        <div class="flex items-center gap-3">
            <i class="fa-solid fa-bolt text-cyan-400 text-lg"></i>
            <h1 class="font-hud text-base font-bold tracking-widest text-white">FEDXAI <span
                    class="text-cyan-400">PRO</span></h1>
        </div>

        <div class="flex gap-1 bg-slate-900 p-0.5 rounded-lg border border-slate-800">
            <button onclick="showPage('live')" id="nav-live"
                class="nav-btn active px-4 py-1 rounded text-xs font-bold tracking-wider text-slate-400 hover:text-white transition-all">
                COCKPIT
            </button>
            <button onclick="showPage('health')" id="nav-health"
                class="nav-btn px-4 py-1 rounded text-xs font-bold tracking-wider text-slate-400 hover:text-white transition-all">
                HEALTH
            </button>
        </div>

        <div class="flex gap-2">
            <button onclick="startSimulation()"
                class="bg-indigo-600 hover:bg-indigo-500 text-white px-3 py-1 rounded text-[10px] font-bold">
                DEMO
            </button>
            <button onclick="connectBLE()" id="btn-conn"
                class="bg-blue-600 hover:bg-blue-500 text-white px-3 py-1 rounded text-[10px] font-bold shadow-lg shadow-blue-500/20">
                CONNECT
            </button>
        </div>
    </nav>

    <!-- CONTENT AREA -->
    <div class="relative flex-1 overflow-hidden p-3 h-full">

        <!-- PAGE 1: LIVE COCKPIT -->
        <div id="page-live" class="h-full flex gap-3">

            <!-- LEFT: GAUGES (Risk Top) -->
            <div class="w-1/4 h-full flex flex-col gap-2">

                <div class="glass-panel rounded-lg p-2 flex-1 flex flex-col justify-center items-center text-center border-l-4 border-transparent"
                    id="box-prob">
                    <h3 class="text-slate-400 text-[10px] font-bold uppercase tracking-widest">AI Risk Level</h3>
                    <div class="font-hud text-3xl font-bold text-green-500 my-1" id="val-prob">0%</div>
                    <div class="text-[9px] text-slate-400">STATUS: SAFE</div>
                </div>

                <div class="glass-panel rounded-lg p-2 flex-1 flex flex-col justify-center items-center text-center">
                    <div class="text-cyan-400 text-lg mb-1"><i class="fa-solid fa-gauge-high"></i></div>
                    <h3 class="text-slate-500 text-[9px] font-bold uppercase">RPM</h3>
                    <div class="font-hud text-2xl font-bold text-white" id="val-rpm">0</div>
                    <div class="w-1/2 bg-slate-800 h-1 rounded-full mt-2 mx-auto">
                        <div id="bar-rpm" class="h-full bg-cyan-400 w-0"></div>
                    </div>
                </div>

                <div class="glass-panel rounded-lg p-2 flex-1 flex flex-col justify-center items-center text-center">
                    <div class="text-orange-400 text-lg mb-1"><i class="fa-solid fa-temperature-half"></i></div>
                    <h3 class="text-slate-500 text-[9px] font-bold uppercase">Coolant</h3>
                    <div class="font-hud text-2xl font-bold text-white" id="val-ct">0°</div>
                </div>

                <div class="glass-panel rounded-lg p-2 flex-1 flex flex-col justify-center items-center text-center">
                    <div class="text-purple-400 text-lg mb-1"><i class="fa-solid fa-wind"></i></div>
                    <h3 class="text-slate-500 text-[9px] font-bold uppercase">Pressure</h3>
                    <div class="font-hud text-2xl font-bold text-white" id="val-fp">0.0</div>
                </div>
            </div>

            <!-- RIGHT: CAR VISUAL & GRAPH -->
            <div class="w-3/4 h-full flex flex-col gap-3">

                <div
                    class="glass-panel rounded-xl relative flex-1 flex items-center justify-center bg-gradient-to-br from-slate-900/60 to-transparent border-2 border-slate-800">
                    <div class="absolute top-2 left-3 text-[10px] font-hud text-cyan-500 tracking-widest">DIGITAL TWIN
                    </div>

                    <div class="relative w-[85%] h-[80%]">
                        <svg viewBox="0 0 800 300" class="w-full h-full drop-shadow-[0_0_15px_rgba(34,211,238,0.2)]"
                            preserveAspectRatio="xMidYMid meet">
                            <defs>
                                <linearGradient id="bodyGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                    <stop offset="0%" style="stop-color:rgba(56,189,248,0.1);stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:rgba(56,189,248,0);stop-opacity:0" />
                                </linearGradient>
                            </defs>
                            <path
                                d="M50,180 L80,140 L200,130 L300,80 L500,80 L620,130 L650,180 L720,180 L720,220 L680,220 A40,40 0 0,1 600,220 L200,220 A40,40 0 0,1 120,220 L20,220 L20,180 Z"
                                class="car-path" />
                            <circle cx="160" cy="220" r="38" class="wheel" />
                            <circle cx="640" cy="220" r="38" class="wheel" />
                        </svg>

                        <!-- INTERACTIVE ICONS -->
                        <!-- 1. Engine -->
                        <div id="grp-eng" class="part-icon-group" style="top: 50%; left: 22%;">
                            <i class="fa-solid fa-gears part-icon"></i><span class="part-label">ENGINE BLOCK</span>
                        </div>

                        <!-- 2. Radiator -->
                        <div id="grp-rad" class="part-icon-group" style="top: 55%; left: 10%;">
                            <i class="fa-solid fa-fan part-icon"></i><span class="part-label">COOLING SYSTEM</span>
                        </div>

                        <!-- 3. Fuel -->
                        <div id="grp-fuel" class="part-icon-group" style="top: 55%; left: 80%;">
                            <i class="fa-solid fa-gas-pump part-icon"></i><span class="part-label">FUEL PUMP</span>
                        </div>

                        <!-- 4. Catalyst -->
                        <div id="grp-cat" class="part-icon-group" style="top: 70%; left: 55%;">
                            <i class="fa-solid fa-fire-burner part-icon"></i><span class="part-label">CATALYST</span>
                        </div>

                        <!-- 5. Alternator (Battery) - NEW -->
                        <div id="grp-alt" class="part-icon-group" style="top: 52%; left: 30%;">
                            <i class="fa-solid fa-car-battery part-icon"></i><span class="part-label">ALTERNATOR</span>
                        </div>

                        <!-- 6. Oil Pan - NEW -->
                        <div id="grp-oil" class="part-icon-group" style="top: 75%; left: 25%;">
                            <i class="fa-solid fa-oil-can part-icon"></i><span class="part-label">OIL PRESSURE</span>
                        </div>

                        <!-- 7. Brakes - NEW -->
                        <div id="grp-brk" class="part-icon-group" style="top: 75%; left: 75%;">
                            <i class="fa-solid fa-compact-disc part-icon"></i><span class="part-label">BRAKE SYS</span>
                        </div>

                    </div>

                    <!-- ALERT BANNER -->
                    <div id="live-alert-box" class="absolute top-4 left-1/2 -translate-x-1/2 z-30 hidden">
                        <div
                            class="bg-red-950/90 text-red-200 px-4 py-2 rounded border border-red-500 flex items-center gap-3 animate-pulse">
                            <i class="fa-solid fa-triangle-exclamation"></i>
                            <span class="font-hud text-xs font-bold" id="live-alert-msg">ENGINE TEMP CRITICAL</span>
                        </div>
                    </div>
                </div>

                <!-- BOTTOM GRAPH -->
                <div class="h-32 glass-panel rounded-xl p-2 bg-slate-900/40 border border-slate-700 w-full">
                    <div class="text-[9px] text-slate-500 uppercase mb-1 ml-1">Live Telemetry History</div>
                    <div class="h-24 w-full"><canvas id="miniChart"></canvas></div>
                </div>
            </div>
        </div>

        <!-- PAGE 2: HEALTH (RESTORED TO DETAILED VERSION) -->
        <div id="page-health" class="hidden h-full max-w-6xl mx-auto flex-col gap-4 overflow-y-auto pr-2 pt-2">

            <div
                class="glass-panel rounded-xl p-6 border-t-4 border-green-500 flex justify-between items-center bg-slate-900/50 shrink-0">
                <div>
                    <h2 class="font-hud text-2xl font-bold text-white">Maintenance Prognostics</h2>
                    <p class="text-slate-400 text-sm">Detailed RUL (Remaining Useful Life) Analysis</p>
                </div>
                <div class="text-right">
                    <div class="font-hud text-5xl font-bold text-green-400" id="rul-score">98%</div>
                    <div class="text-[10px] uppercase tracking-widest text-slate-500">System Health</div>
                </div>
            </div>

            <!-- RESTORED GRID CARDS -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 pb-4">
                <!-- FUEL -->
                <div class="glass-panel p-4 rounded-xl hover:bg-slate-800/40 transition-colors">
                    <div class="flex justify-between mb-2"><i class="fa-solid fa-gas-pump text-blue-400"></i><span
                            class="font-hud text-green-400 text-xs" id="rul-fuel">6+ Months</span></div>
                    <h3 class="font-bold text-slate-200 text-sm">Fuel Injection</h3>
                    <div class="h-1 bg-slate-800 rounded-full mt-2 mb-1">
                        <div class="h-full bg-green-500 w-[95%]" id="bar-fuel"></div>
                    </div>
                    <p class="text-[10px] text-slate-500">Pressure stable.</p>
                </div>
                <!-- COOLING -->
                <div class="glass-panel p-4 rounded-xl hover:bg-slate-800/40 transition-colors">
                    <div class="flex justify-between mb-2"><i class="fa-solid fa-fan text-orange-400"></i><span
                            class="font-hud text-green-400 text-xs" id="rul-cool">6+ Months</span></div>
                    <h3 class="font-bold text-slate-200 text-sm">Cooling System</h3>
                    <div class="h-1 bg-slate-800 rounded-full mt-2 mb-1">
                        <div class="h-full bg-green-500 w-[92%]" id="bar-cool"></div>
                    </div>
                    <p class="text-[10px] text-slate-500">Thermostat OK.</p>
                </div>
                <!-- ENGINE -->
                <div class="glass-panel p-4 rounded-xl hover:bg-slate-800/40 transition-colors">
                    <div class="flex justify-between mb-2"><i class="fa-solid fa-gears text-purple-400"></i><span
                            class="font-hud text-green-400 text-xs" id="rul-eng">6+ Months</span></div>
                    <h3 class="font-bold text-slate-200 text-sm">Engine Block</h3>
                    <div class="h-1 bg-slate-800 rounded-full mt-2 mb-1">
                        <div class="h-full bg-green-500 w-[98%]" id="bar-eng"></div>
                    </div>
                    <p class="text-[10px] text-slate-500">No vibration.</p>
                </div>
                <!-- CATALYST -->
                <div class="glass-panel p-4 rounded-xl hover:bg-slate-800/40 transition-colors">
                    <div class="flex justify-between mb-2"><i class="fa-solid fa-fire-burner text-slate-400"></i><span
                            class="font-hud text-yellow-400 text-xs" id="rul-cat">4 Months</span></div>
                    <h3 class="font-bold text-slate-200 text-sm">Catalyst</h3>
                    <div class="h-1 bg-slate-800 rounded-full mt-2 mb-1">
                        <div class="h-full bg-yellow-500 w-[75%]" id="bar-cat"></div>
                    </div>
                    <p class="text-[10px] text-slate-500">Efficiency 85%.</p>
                </div>
                <!-- BATTERY -->
                <div class="glass-panel p-4 rounded-xl hover:bg-slate-800/40 transition-colors">
                    <div class="flex justify-between mb-2"><i class="fa-solid fa-car-battery text-red-400"></i><span
                            class="font-hud text-green-400 text-xs">1 Year</span></div>
                    <h3 class="font-bold text-slate-200 text-sm">Battery</h3>
                    <div class="h-1 bg-slate-800 rounded-full mt-2 mb-1">
                        <div class="h-full bg-green-500 w-[90%]" style="width:90%"></div>
                    </div>
                    <p class="text-[10px] text-slate-500">12.6V Idle.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script>
        function showPage(id) {
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`nav-${id}`).classList.add('active');
            document.getElementById('page-live').classList.add('hidden');
            document.getElementById('page-health').classList.add('hidden');
            if (id === 'live') {
                document.getElementById('page-live').classList.remove('hidden');
                document.getElementById('page-live').classList.add('flex');
            } else {
                document.getElementById('page-health').classList.remove('hidden');
                document.getElementById('page-health').classList.add('flex');
            }
        }

        const ctx = document.getElementById('miniChart').getContext('2d');
        const chart = new Chart(ctx, {
            type: 'line',
            data: { labels: Array(30).fill(''), datasets: [{ label: 'RPM', data: Array(30).fill(0), borderColor: '#22d3ee', borderWidth: 1, pointRadius: 0, tension: 0.4 }, { label: 'Temp', data: Array(30).fill(0), borderColor: '#f97316', borderWidth: 1, pointRadius: 0, tension: 0.4 }] },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false } }, animation: false }
        });

        function updateLiveUI(data) {
            document.getElementById('val-rpm').innerText = data.rpm.toFixed(0);
            document.getElementById('val-ct').innerText = data.ct.toFixed(1) + '°';
            document.getElementById('val-fp').innerText = data.fp.toFixed(1);
            document.getElementById('bar-rpm').style.width = Math.min(100, (data.rpm / 80)) + '%';
            chart.data.datasets[0].data.push(data.rpm / 80);
            chart.data.datasets[1].data.push(data.ct);
            chart.data.datasets.forEach(ds => ds.data.shift());
            chart.update('none');
        }

        function triggerAlert(groupId, msg, isCritical) {
            document.querySelectorAll('.part-critical').forEach(el => el.classList.remove('part-critical'));
            document.getElementById('live-alert-box').classList.add('hidden');
            document.getElementById('box-prob').className = "glass-panel rounded-lg p-2 flex-1 flex flex-col justify-center items-center text-center border-l-4 border-transparent";

            if (isCritical) {
                document.getElementById('val-prob').innerText = (85 + Math.random() * 10).toFixed(0) + '%';
                document.getElementById('val-prob').className = "font-hud text-3xl font-bold text-red-500 my-1 animate-pulse";
                document.getElementById('box-prob').className = "glass-panel rounded-lg p-2 flex-1 flex flex-col justify-center items-center text-center border-l-4 border-red-500 bg-red-900/20";

                if (groupId) document.getElementById(groupId).classList.add('part-critical');
                document.getElementById('live-alert-box').classList.remove('hidden');
                document.getElementById('live-alert-msg').innerText = msg;

                // Health Page
                document.getElementById('rul-score').innerText = "CRITICAL";
                document.getElementById('rul-score').className = "font-hud text-5xl font-bold text-red-500";
                if (groupId === 'grp-fuel') updateHealthBar('fuel', 'IMMEDIATE', '5%', 'bg-red-500');
                if (groupId === 'grp-rad') updateHealthBar('cool', '1 Week', '10%', 'bg-red-500');

            } else {
                document.getElementById('val-prob').innerText = (Math.random() * 2).toFixed(0) + '%';
                document.getElementById('val-prob').className = "font-hud text-3xl font-bold text-green-500 my-1";
                document.getElementById('rul-score').innerText = "98%";
                document.getElementById('rul-score').className = "font-hud text-5xl font-bold text-green-400";
                updateHealthBar('fuel', '6+ Months', '95%', 'bg-green-500');
                updateHealthBar('cool', '6+ Months', '92%', 'bg-green-500');
            }
        }

        function updateHealthBar(id, text, width, colorClass) {
            document.getElementById(`rul-${id}`).innerText = text;
            const bar = document.getElementById(`bar-${id}`);
            bar.className = `h-full w-full transition-all duration-1000 ${colorClass}`;
            bar.style.width = width;
            document.getElementById(`rul-${id}`).className = `font-hud text-xs ${colorClass.replace('bg-', 'text-')}`;
        }

        let simInterval;
        function startSimulation() {
            if (simInterval) clearInterval(simInterval);
            let t = 0;
            simInterval = setInterval(() => {
                t += 0.1;
                const rpm = 3000 + Math.sin(t) * 1000 + (Math.random() * 100);
                const ct = 90 + Math.sin(t * 0.5) * 5;
                const fp = 3.5 + Math.cos(t) * 0.2;
                updateLiveUI({ rpm, ct, fp });

                const cycle = Math.floor(t) % 20;
                if (cycle > 15 && cycle < 18) {
                    triggerAlert('grp-fuel', "FUEL PUMP FAILURE", true);
                    updateLiveUI({ rpm: rpm * 0.9, ct: ct, fp: 1.5 });
                } else if (cycle > 18) {
                    triggerAlert('grp-rad', "RADIATOR LEAK", true);
                    updateLiveUI({ rpm: rpm, ct: 115, fp: fp });
                } else {
                    triggerAlert(null, "System OK", false);
                }
            }, 600);
        }

        const SERVICE_UUID = '4fafc201-1fb5-459e-8fcc-c5c9c331914b';
        const CHAR_PROB_UUID = 'beb5483e-36e1-4688-b7f5-ea07361b26a9';
        const CHAR_ALERT_UUID = 'beb5483e-36e1-4688-b7f5-ea07361b26aa';
        const CHAR_SENSORS_UUID = 'beb5483e-36e1-4688-b7f5-ea07361b26ab';

        async function connectBLE() {
            clearInterval(simInterval);
            try {
                if (!navigator.bluetooth) throw new Error("Web Bluetooth unavailable.");
                const device = await navigator.bluetooth.requestDevice({ filters: [{ name: 'FedXAI-Dongle' }], optionalServices: [SERVICE_UUID] });
                const server = await device.gatt.connect();
                const service = await server.getPrimaryService(SERVICE_UUID);

                const charSens = await service.getCharacteristic(CHAR_SENSORS_UUID);
                await charSens.startNotifications();
                charSens.addEventListener('characteristicvaluechanged', e => updateLiveUI(JSON.parse(new TextDecoder().decode(e.target.value))));

                const charProb = await service.getCharacteristic(CHAR_PROB_UUID);
                await charProb.startNotifications();
                charProb.addEventListener('characteristicvaluechanged', e => {
                    const prob = e.target.value.getFloat32(0, true);
                    if (prob > 0.5) triggerAlert('grp-eng', "Anomaly Detected", true);
                    else triggerAlert(null, "System OK", false);
                });

                document.getElementById('btn-conn').innerText = "LINKED";
                document.getElementById('btn-conn').className = "bg-green-600 px-3 py-1 rounded text-[10px] font-bold shadow-lg";
            } catch (e) { alert(e); }
        }
    </script>
</body>

</html>